"0","predictions <- predict(rf2, nba.data.before)"
"0",""
"0","sensitivities <- c()"
"0","specificities <- c()"
"0","ourMetric <- c()"
"0","possible.threshold <- seq(from = 0.05,"
"0","                        to = 0.2,"
"0","                        by = 0.01)"
"0",""
"0","for(threshold in possible.threshold){"
"0","   "
"0","   X <- threshold"
"0","   "
"0","   nba.data.before.new <- nba.data.before %>%"
"0","     mutate(preds = case_when(predictions$predictions[,2] >= X ~ ""Yes"","
"0","                              TRUE ~ ""No""))"
"0","   "
"0","   #Confusion Matrix"
"0","   confusionMatrix <- table(nba.data.before.new$`rating`, nba.data.before.new$preds)"
"0",""
"0","   #"
"0","   sensitivities <- c(sensitivities, confusionMatrix[4]/(confusionMatrix[4]+confusionMatrix[2]))"
"0","   specificities <- c(specificities, confusionMatrix[1]/(confusionMatrix[1]+confusionMatrix[3]))"
"0","   "
"0","   #ourMetric <- c(ourMetric, 2*(confusionMatrix[4]/(confusionMatrix[4]+confusionMatrix[2]))+confusionMatrix[1]/(confusionMatrix[1]+confusionMatrix[3]))"
"0","}"
"2","Error: Problem with `mutate()` input `preds`.
[31mx[39m $ operator is invalid for atomic vectors
[34mâ„¹[39m Input `preds` is `case_when(predictions$predictions[, 2] >= X ~ ""Yes"", TRUE ~ ""No"")`.
"
